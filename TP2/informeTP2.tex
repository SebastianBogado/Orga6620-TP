%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Definici\'on del tipo de documento.                                           %
% Posibles tipos de papel: a4paper, letterpaper, legalpapper                  %
% Posibles tama�os de letra: 10pt, 11pt, 12pt                                 %
% Posibles clases de documentos: article, report, book, slides                %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[a4paper,10pt]{article}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Los paquetes permiten ampliar las capacidades de LaTeX.                     %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Paquete para inclusi\'on de gr\'aficos.
\usepackage{graphicx}

% Paquete para definir la codificaci\'on del conjunto de caracteres usado
% (latin1 es ISO 8859-1).
\usepackage[latin1]{inputenc}

% Paquete para definir el idioma usado.
\usepackage[spanish]{babel}

\usepackage{multirow} 

% Paquete para f\'ormulas matem\'aticas
\usepackage{amsmath}
\newcommand{\BigO}[1]{\ensuremath{\operatorname{O}\bigl(#1\bigr)}}

%\usepackage{multicolumn} 

% T\'itulo principal del documento.
\title{		\textbf{Trabajo pr\'actico 2: Profiling y Optimizaci\'on }}

% Informaci\'on sobre los autores.
\author{	Alejandro Garc\'ia Marra, \textit{Padr\'on Nro. 91.516}                     \\
            \texttt{ alemarra@gmail.com }                                              \\
            Sebasti\'an Javier Bogado, \textit{Padr\'on Nro. 91.707}                     \\
            \texttt{ sebastian.j.bogado@gmail.com }                                              \\
            \normalsize{Grupo Nro. 0 - 2do. Cuatrimestre de 2012}                       \\
            \normalsize{66.20 Organizaci\'on de Computadoras}                             \\
            \normalsize{Facultad de Ingenier\'ia, Universidad de Buenos Aires}            \\
       }
\date{}



\begin{document}

% Inserta el t\'itulo.
\maketitle

% Quita el n\'umero en la primer p\'agina.
\thispagestyle{empty}

% Resumen
\begin{abstract}

\end{abstract}

\newpage
\section{Introducci\'on}

Muchas veces tanto para programas reci\'en terminados, como para aquellos que llevan un tiempo en funcionamiento, se desconoce realmente qu\'e partes del programa insumen la mayor cantidad de recursos, sean estos de tiempo, carga de cpu, etc.
Poseer esta informaci\'on se torna en algo cr\'itico cuando se busca realizar una mejora de performance en dicho programa. Ser\'ia poco \'util intentar optimizar a ciegas, por no decir in\'util.\\
Haremos uso entonces de dos m\'etodos distintos en el estudio del programa, el profiling (por medio de \textit{gprof} y \textit{cachegrind}) y la medici\'on de los tiempos de ejecuci\'on (por medio de \textit{time}). 

\subsection{Profiling}

	Se denomina as\'i al an\'alisis din\'amico de un programa, con el fin de estudiar su comportamiento.\\
	Al recolectar informaci\'on en tiempo de ejecuci\'on, puede utilizarse en aquellos programas demasiado grandes o complejos, donde un an\'alisis
 por lectura de fuentes ser\'ia impracticable.\\
	Como consecuencia del an\'alisis durante la ejecuci\'on, los datos con los que se corra el programa afectaran el resultado del profiler. 
 Es decir, distintos datos de entrada pueden provocar distintas ramas de ejecuci\'on, dando por resultado que, por ejemplo, no se llamen algunas funciones.

 \begin{itemize}
	
\item {\textbf{gprof:} } {Permite aprender donde el programa pasa la mayor parte de su tiempo, y cuales funciones llaman a otras mientras se ejecuta.\\
 			   Esta informacion puede mostrar qu\'e piezas del programa son mas lentas de lo esperado, convirti\'endolas en candidatas para su reescritura en la etapa de optimizaci\'on.\\
 			   Tambi\'en puede ayudarnos a descubrir cuales funciones son llamadas m\'as o menos veces delo esperado, pudiendo encontrar nuevos bugs (aunque el descubrimiento de bugs no es el fin principal de esta etapa)
 			   }

\item{\textbf{cachegrind:}}{ Simula el comportamiento del programa sobre una determinada jerarqu\'ia de cache, la cual puede ser establecida por medio de distintas opciones. 
			Como resultado, se obtiene una visi\'on muy precisa de la cantidad de referencias a elementos del cache de instrucciones y al cache de datos, la cantidad de misses para ambos y el miss rate correspondiente.\\
			En particular nos interesan los resultados para la cache de datos D1, y el miss rate de la misma.}
			
\end{itemize}
			   
\subsection{Medici\'on de Tiempos}

Permite conocer con precisi\'on los tiempos de ejecuci\'on de un programa, discriminados entre tiempos de systema, de usario, tiempos totales, etc., as\'i como tambi\'en conocer los porcentajes para cada parte del programa, cantidad de entradas, y muchas otras opciones.\\
				     La combinaci\'on con una herramienta de profiling permite exactitud a la hora de conocer la forma en que se ejecuta el programa bajo estudio, permitiendo optimizar \'unicamente las partes cr\'iticas del ciclo de ejecuci\'on.

\newpage


\section{Flujo del programa}
Se trata de una versi\'on en lenguaje C de la simulaci\'on del planeta WATOR. El programa recibe un nombre de archivo en el que se van dejando
las cantidades de peces y tiburones en cada turno, y simula 1000 turnos en un planeta de 32x32 celdas.\\

Comienza por la inicializaci\'on de la matriz, recorriendo la misma en su totalidad y ubicando de forma aleatoria espacios vac\'ios, peces o tiburones. \\ 
Luego, se muestra completa por pantalla, acci\'on que se realiza en cada uno de los ciclos.\\

Una vez completada la inicializaci\'on, comienza el ciclo de simulaci\'on. Por cada ciclo se busca mover todos los elementos no vacios de la matriz. El comportamiento para
peces o tiburones es distinto, por lo que en cada caso se eval\'ua el curso de acci\'on, dependiendo tambi\'en de los elementos que rodean la posici\'on actual.\\

Cada moviemiento depende del c\'alculo de la nueva posici\'on, reemplazando el elemento previo si es necesario y teniendo en cuenta la tasa de natalidad y mortalidad de cada uno de los factores.

\section{Hip\'otesis y Aclaraciones}

\begin{itemize}
 \item {Todas las mediciones se realizan redireccionando la salida por pantalla a \/dev\/null. Esto nos permite ahorrar tiempo en las pruebas sin afectar las mediciones, ya que el tiempo de impresi\'on se puede considerar constante para todas las mediciones.}
 
 \item {Consideramos las dimesiones de la matriz (como indica el enunciado, 32x32) como un elemento invariante. Esto nos permite, como veremos m\'as adelante, realizar optimizaciones interesantes que de otra forma no ser\'ian posibles.}
 
 \item {Todas las mediciones que resulten de un promedio de corridas ser\'an acompa\~nadas del n\'umero de corridas correspondiente, as\'i como el m\'aximo y m\'inimo de la serie.}
 \item {La compilaci\'on de los c\'odigos fuente se realiza con el comando: 
		\begin{quote}
			\begin{verbatim}
				gcc -DNDEBUG fuente.c -o fuente
			\end{verbatim}
		\end{quote}
	En ning\'un momento (a menos que aclare lo contrario) se utilizan las opciones de optimizaci\'on del gcc. El \'unico caso donde se modifica este comando es para la compilaci\'on previa a la corrida con gprof.}
 \item {Los scripts con los que se realizaron las mediciones promediadas se encuentran disponibles en el cd bajo el nombre XXXXCollect.sh}
 
\end{itemize}
 
\newpage

\section{Comparaci\'on de Versiones}

Todas las modifiaciones se expresan en relaci\'on con la versi\'on anterior. Los cambios enunciados son acumulativos.



\section{Corridas de prueba y Mediciones}


\newpage

\section{Análisis de los Datos}



\section{Conclusiones}

% Citas bibliogr\'aficas.
\begin{thebibliography}{99}


\end{thebibliography}

\end{document}
